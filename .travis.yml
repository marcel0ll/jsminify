sudo: false
language: node_js
node_js:
- node
addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test
    packages:
    - g++-4.8
    - gcc-4.8-multilib
    - g++-4.8-multilib
    - gcc-multilib
    - g++-multilib
os:
- osx
- linux
before_deploy:
- ARCHIVE_NAME="${TRAVIS_TAG:-latest}-$TRAVIS_OS_NAME-`uname -m`.tar"
- npm run prebuild
- if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then ARCH=ia32 npm run prebuild; fi
- tar --create --verbose --file="$ARCHIVE_NAME" --directory "$TRAVIS_BUILD_DIR/prebuilds"
  .
deploy:
  provider: releases
  draft: false
  prerelease: true
  file: "$ARCHIVE_NAME"
  skip_cleanup: true
  on:
    tags: true
    node: node
  api_key:
    secure: "isF23J0Uq5/iWsbyNDITLGodJrmC8Rp4USJyhSDa+xyJgQq25OJNdzG86wQcVR9E3Hzt1xafcZXbj2fmIyTdgJplgnru5NSelNMd3lUGkiQqFfhwKnarjSKI2jpwQPXCHGehJ+fsQrPTWfdFU5UCQrbzzGN01DTgYHugX5CFeUtNHnEejeu6EY3fjsW/vZcIk1cMn1Hk5ovMVKmUf4t1mxgcvCI2TC+I+i2FxK2kiClXSUno1iBoBhYEXit2VGY7yw288W13zqSY/3I0Q12B+8TINwGQQKZfBwncKGoYkt9L3IKvf5me+JPQYG1/mfHO6y6j2SEeNUzN+3NCceLxoeFVvqIpAikhHNaDETiosLzFkZK0GUE25KjaTl0uMQ/Dr7Aok9y+6tWAV4ngJn/cYPlQTuHsuRJt4/ERVAA5zvUc2LDRhJ4bSSxYmeonoL6xfDN2CJFh6SSflbJSgtWSWO9xefvf8L/66UC+LhDwPQDKH/UIecLxwwtVHksivtA60EuO4CpocUD/UUar0H0t8IXkZzA9ZO/oW6gX5+vtbOQ2oH1Rtaw9+RsrqPTZBBg+T/Td6DjGjFKpPPRbwhPTUL6A+IfDVTZtxe49H1lOpurnWSv+kHt8yLFeCkTmfCVoHauGilCVxpgvpACHuA7l7KNUQ+L+42ivwNfeVtBjiII="
