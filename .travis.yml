sudo: false
language: node_js
node_js:
- node
addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test
    packages:
    - g++-4.8
    - gcc-4.8-multilib
    - g++-4.8-multilib
    - gcc-multilib
    - g++-multilib
os:
- osx
- linux
before_deploy:
- ARCHIVE_NAME="${TRAVIS_TAG:-latest}-$TRAVIS_OS_NAME-`uname -m`.tar"
- npm run prebuild
- if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then ARCH=ia32 npm run prebuild; fi
- tar --create --verbose --file="$ARCHIVE_NAME" --directory "$TRAVIS_BUILD_DIR/prebuilds"
  .
deploy:
  provider: releases
  draft: false
  prerelease: true
  file: "$ARCHIVE_NAME"
  skip_cleanup: true
  on:
    tags: true
    node: node
  api_key:
    secure: oQUbfY92tdUkDgdXHI5+m2eS3YFCKXL8pr+bi1Pi6wU7KS1bjxXc5pfFiHnj8X+tsny0v3iBpxZWIeX08SK9ytr7/H0Jy/xsTNdXbZfa8B0YIQJtw3praBjbyu/ZqOvgPC9KxrqdfeNo2bN+6ht4d8BWWFNDJo4HXbCEgxg94hLCfKmZlxvjIDUW64BO9nhM+KBxUDzjMgPCu/HCkrD0Z70X8zZIPabjhJN//LcdVIs/GtA4Zce240zj0mPn6i8dcgOhcUZdYhLrZMj1Z0kgKFB0hkW9LoDNSrsrvPNbpZYy+3wrMplZXLR1nWYKOrcaqHnBjgun6j96vnNvDdMC2U4FTj/RBizJueJ9Bvil3l5OwXd86JF0jLWez9asW9pob/DpiJ5c5TSK5tamzvM42i73InNFBNhnTR2D0N91csyTWe0q7Iw3aQ/wIcujz3GHSjZNjAuIObnJXWsOmchS60f7lejUu4e208iBasmvBuJeQSuAgvzQKJwXycmXkUdMh+Tai8K/9z9VtZBxthq+EERrKQkMEyQ7hAeQ+FHY/e+fo2bjF7VnKWDtjgQCjBTmVVvnrfWt3/4t+ftgGUTC2JVSpyzwm+Zty/2vbDtvQC+KvQI7w+Elz/qOOTxEnGxZwSAwnY3UsxVPa4NVR3AroB5drva9yOzsdq6tuoFLP0M=
